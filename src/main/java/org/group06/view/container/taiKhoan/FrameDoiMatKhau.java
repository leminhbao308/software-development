/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package org.group06.view.container.taiKhoan;

import javax.swing.JOptionPane;
import org.group06.db.DatabaseConnect;
import org.group06.db.dao.DAO_NhanVien;
import org.group06.model.entity.NhanVien;

/**
 *
 * @author Le Minh Bao
 */
public class FrameDoiMatKhau extends javax.swing.JFrame {

    private NhanVien nv;
    private DAO_NhanVien dao_NhanVien = new DAO_NhanVien(DatabaseConnect.getConnection());

    /**
     * Creates new form FrameDoiMatKhau
     */
    public FrameDoiMatKhau(NhanVien nv) {
        this.setResizable(false);
        this.nv = nv;
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        lblMKCu = new javax.swing.JLabel();
        lblTitle = new javax.swing.JLabel();
        pwdMKCu = new javax.swing.JPasswordField();
        btnMKCu = new javax.swing.JButton();
        pwdMKMoi = new javax.swing.JPasswordField();
        lblMKMoi = new javax.swing.JLabel();
        btnMKMoi = new javax.swing.JButton();
        lblNhapMKMoi = new javax.swing.JLabel();
        pwdNhapMKMoi = new javax.swing.JPasswordField();
        btnNhapMKMoi = new javax.swing.JButton();
        lblComment = new javax.swing.JLabel();
        pnlChucNang = new javax.swing.JPanel();
        filler1 = new javax.swing.Box.Filler(new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 0), new java.awt.Dimension(32767, 0));
        btnCapNhat = new javax.swing.JButton();
        btnHuy = new javax.swing.JButton();

        lblMKCu.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        lblMKCu.setText("Nhập mật khẩu cũ");

        lblTitle.setFont(new java.awt.Font("Segoe UI", 1, 36)); // NOI18N
        lblTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTitle.setText("Đổi Mật Khẩu");
        lblTitle.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);

        btnMKCu.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnMKCu.setText("Hiện");
        btnMKCu.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnMKCu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMKCuActionPerformed(evt);
            }
        });

        lblMKMoi.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        lblMKMoi.setText("Nhập mật khẩu mới");

        btnMKMoi.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnMKMoi.setText("Hiện");
        btnMKMoi.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnMKMoi.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnMKMoiMouseClicked(evt);
            }
        });
        btnMKMoi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMKMoiActionPerformed(evt);
            }
        });

        lblNhapMKMoi.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        lblNhapMKMoi.setText("Nhập lại mật khẩu mới");

        btnNhapMKMoi.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnNhapMKMoi.setText("Hiện");
        btnNhapMKMoi.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnNhapMKMoi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNhapMKMoiActionPerformed(evt);
            }
        });

        lblComment.setFont(new java.awt.Font("Segoe UI", 2, 14)); // NOI18N
        lblComment.setForeground(new java.awt.Color(255, 0, 0));
        lblComment.setText("Mật khẩu có tối thiểu 8 ký tự, có ít nhất 1 chữ số và một ký tự đặc biệt");

        pnlChucNang.setLayout(new java.awt.GridLayout(1, 3, 30, 0));
        pnlChucNang.add(filler1);

        btnCapNhat.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnCapNhat.setText("Cập Nhật");
        btnCapNhat.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnCapNhat.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCapNhatActionPerformed(evt);
            }
        });
        pnlChucNang.add(btnCapNhat);

        btnHuy.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnHuy.setText("Huỷ");
        btnHuy.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnHuy.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnHuyActionPerformed(evt);
            }
        });
        pnlChucNang.add(btnHuy);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addComponent(lblTitle, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())
                    .addGroup(layout.createSequentialGroup()
                        .addGap(32, 32, 32)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblMKCu, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                .addComponent(pwdMKCu)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnMKCu, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(pwdMKMoi)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnMKMoi, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(lblMKMoi, javax.swing.GroupLayout.DEFAULT_SIZE, 520, Short.MAX_VALUE)
                            .addComponent(lblNhapMKMoi, javax.swing.GroupLayout.DEFAULT_SIZE, 520, Short.MAX_VALUE)
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(pwdNhapMKMoi)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnNhapMKMoi, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(pnlChucNang, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblComment, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(37, 37, 37))))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lblTitle)
                .addGap(18, 18, 18)
                .addComponent(lblMKCu)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnMKCu, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(pwdMKCu))
                .addGap(18, 18, 18)
                .addComponent(lblMKMoi)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnMKMoi, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(pwdMKMoi))
                .addGap(18, 18, 18)
                .addComponent(lblNhapMKMoi)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnNhapMKMoi, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(pwdNhapMKMoi))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblComment, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(pnlChucNang, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {btnMKCu, pwdMKCu});

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void btnHuyActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnHuyActionPerformed
        this.dispose();
    }//GEN-LAST:event_btnHuyActionPerformed

    private void btnMKMoiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMKMoiActionPerformed
        if (btnMKMoi.getText().equals("Hiện")) {
            pwdMKMoi.setEchoChar('\u0000');
            btnMKMoi.setText("Ẩn");
        } else {
            pwdMKMoi.setEchoChar('•');
            btnMKMoi.setText("Hiện");
        }
    }//GEN-LAST:event_btnMKMoiActionPerformed

    private void btnMKCuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMKCuActionPerformed
        if (btnMKCu.getText().equals("Hiện")) {
            pwdMKCu.setEchoChar('\u0000');
            btnMKCu.setText("Ẩn");
        } else {
            pwdMKCu.setEchoChar('•');
            btnMKCu.setText("Hiện");
        }
    }//GEN-LAST:event_btnMKCuActionPerformed

    private void btnNhapMKMoiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNhapMKMoiActionPerformed
        if (btnNhapMKMoi.getText().equals("Hiện")) {
            pwdNhapMKMoi.setEchoChar('\u0000');
            btnNhapMKMoi.setText("Ẩn");
        } else {
            pwdNhapMKMoi.setEchoChar('•');
            btnNhapMKMoi.setText("Hiện");
        }
    }//GEN-LAST:event_btnNhapMKMoiActionPerformed

    private void btnMKMoiMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnMKMoiMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_btnMKMoiMouseClicked

    private void btnCapNhatActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCapNhatActionPerformed
        if(nv.getMatKhau().equals(new String(pwdMKCu.getPassword()))) {
            if(new String(pwdMKMoi.getPassword()).equals(new String(pwdNhapMKMoi.getPassword()))) {
                
                if(dao_NhanVien.updateMatKhau(nv.getMaNV(), new String(pwdMKMoi.getPassword()))) {
                    JOptionPane.showMessageDialog(this, "Cập nhật thành công");
                    this.dispose();
                } else
                    JOptionPane.showMessageDialog(this, "Cập nhật không thành công");
            } else {
                JOptionPane.showMessageDialog(this, "Mật khẩu không trùng khớp, vui lòng nhập lại");
            }
        } else {
            JOptionPane.showMessageDialog(this, "Mật khẩu không trùng khớp, vui lòng nhập lại");
        }
    }//GEN-LAST:event_btnCapNhatActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCapNhat;
    private javax.swing.JButton btnHuy;
    private javax.swing.JButton btnMKCu;
    private javax.swing.JButton btnMKMoi;
    private javax.swing.JButton btnNhapMKMoi;
    private javax.swing.Box.Filler filler1;
    private javax.swing.JLabel lblComment;
    private javax.swing.JLabel lblMKCu;
    private javax.swing.JLabel lblMKMoi;
    private javax.swing.JLabel lblNhapMKMoi;
    private javax.swing.JLabel lblTitle;
    private javax.swing.JPanel pnlChucNang;
    private javax.swing.JPasswordField pwdMKCu;
    private javax.swing.JPasswordField pwdMKMoi;
    private javax.swing.JPasswordField pwdNhapMKMoi;
    // End of variables declaration//GEN-END:variables
}
